function AddToFavorites() {
    var myUrl, title;
    title = document.title;
    myUrl = document.location.href;
    if (window.sidebar) {
        window.sidebar.addPanel(title, myUrl, '');
    } else if (window.external) {
        window.external.AddFavorite(myUrl, title);
    }
}

function ClipBoard() {
    var objHoldText = document.getElementById('holdtext');
    objHoldText.innerText = document.location.href;
    libCopyToClipboard(objHoldText.innerText);
    alert("The link to this search has now been copied to the clipboard");
}

window.onload = function () {
    setBodyScroll();
};

$(document).ready(function () {
    $('a.openDocumentMenu').click(setToogleMenu);
    $('a.closeDocumentMenu').click(function () {
        $(this).parent().fadeOut('fast');
    });
});

function setBodyScroll() {
    if (!document.getElementById('frame')) {
        window.body1.scroll = 'yes';
        document.getElementById('body1').style.height = '1200';
        document.getElementById('form1').style.height = '1200';
    }
    if (document.getElementById('FlashPlayerPanel')) {
        window.body1.scroll = 'yes';
        document.getElementById('body1').style.height = '';
        document.getElementById('form1').style.height = '';
    }
}

function setToogleMenu(event) {
    var box = $(event.currentTarget).next();

    if (!box.is(':visible')) {
        box.css('top', event.pageY + 20);
        box.css('left', event.pageX - 15);
        $('a.openDocumentMenu+div.introtext:visible').fadeOut('fast');
    }
    
    box.fadeToggle('fast', function () {
        removeOpFilter(this);
    });
}

function removeOpFilter(element) {
    var isIe = false;
    if (typeof (jQuery.browser) != "undefined" && typeof (jQuery.browser.msie) != "undefined") {
        isIe = jQuery.browser.msie;
    } else if (typeof (Sys) != "undefined" && typeof (Sys.Browser) != "undefined") {
        isIe = Sys.Browser.name == 'Microsoft Internet Explorer';
    }

    if (isIe) {
        element.style.removeAttribute("filter");
    }
}